<html>

<head>
    <meta charset="UTF-8">
</head>

<body>
    <div class="container">
        <textarea id="content"></textarea>
    </div>
</body>
<script>
    const content = document.getElementById('content');
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200 ) {
            content.value = this.responseText;
        }
    };
    xhttp.open("GET", "api/text", true);
    xhttp.send();

    function debounce(func, wait) {
        let timeout;
        return function () {
            const context = this;
            const args = arguments;
            clearTimeout(timeout);
            timeout = setTimeout(function () {
                func.apply(context, args);
            }, wait);
        };
    }

    function updateContent(event) {
        let post = JSON.stringify({ content: content.value })
        let xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
            }
        };
        xhttp.open("POST", "api/text", true);
        xhttp.setRequestHeader('Content-type', 'application/json; charset=UTF-8')
        xhttp.send(post);
    }

    const debouncedSetContent = debounce(updateContent, 500);
    content.addEventListener('keyup', debouncedSetContent);

</script>
<style>
    .container {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 80vh;
    }

    #content {
        width: 80%;
        height: 60%;
    }
</style>

</html>
